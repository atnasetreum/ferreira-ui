(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[384],{6393:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/rutas",function(){return n(5493)}])},5493:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return el}});var l=n(5893),i=n(6863),t=n(1057),s=n(6886),c=n(7294),o=n(629),a=n(1903),d=n(8854),x=n(9521),h=n(7179),u=n(9272),m=n(9294),j=n(6963),g=n(7145),f=n.n(g),p=n(1733),Z=n(3946),b=n(7906),v=n(295),y=n(2882),k=n(3184),w=n(2610);let Y=e=>{let{columns:r,form:n,form:{sellers:i},setForm:t}=e,s=c.useCallback(e=>e.id,[]),{getTableProps:o,getTableBodyProps:a,headerGroups:u,rows:m,prepareRow:g}=(0,x.useTable)({data:i,columns:r,getRowId:s}),p=(e,r)=>{let l=i[e];t({...n,sellers:f()(i,{$splice:[[e,1],[r,0,l]]}).map((e,r)=>({...e,order:r+1}))})};return(0,l.jsx)(h.W,{backend:j.PD,children:(0,l.jsxs)(b.Z,{...o(),children:[(0,l.jsx)(k.Z,{children:u.map(e=>{let{key:r,...n}=e.getHeaderGroupProps();return(0,l.jsxs)(d.AF,{...n,children:[(0,l.jsx)(d.Yk,{}),e.headers.map(e=>{let{key:r,...n}=e.getHeaderProps();return(0,l.jsx)(d.Yk,{align:"center",...n,children:e.render("Header")},r)})]},r)})}),(0,l.jsx)(v.Z,{...a(),children:m.map((e,r)=>null!==g(e)&&g(e)||(0,l.jsx)(S,{index:r,row:e,moveRow:p,...e.getRowProps()}))})]})})},S=e=>{let{row:r,index:n,moveRow:i}=e,t=c.useRef(null),s=c.useRef(null),[,o]=(0,u.L)({accept:"row",hover(e,r){if(!t.current)return;let l=e.index;if(l===n)return;let s=t.current.getBoundingClientRect(),c=(s.bottom-s.top)/2,o=r.getClientOffset(),a=o.y-s.top;l<n&&a<c||l>n&&a>c||(i(l,n),e.index=n)}}),[{isDragging:a},x,h]=(0,m.c)({type:"row",item:{type:"row",index:n},collect:e=>({isDragging:e.isDragging()})});return h(o(t)),x(s),(0,l.jsxs)(d.AF,{ref:t,style:{opacity:a?0:1},children:[(0,l.jsx)(d.Yk,{align:"center",ref:s,children:(0,l.jsx)(w.Z,{})}),r.cells.map(e=>{let{key:r,...n}=e.getCellProps();return(0,l.jsx)(d.Yk,{align:"center",...n,children:e.render("Cell")},r)})]})},A=e=>{let{sellers:r,form:n,setForm:t}=e,s=c.useMemo(()=>[{Header:"Orden",accessor:"order"},{Header:"UUID",accessor:"uuid"},{Header:"Seller",accessor:"nombre"},{Header:"Acciones",accessor:"id",Cell:e=>(0,l.jsx)(i.Z,{"aria-label":"outlined primary button group",children:(0,l.jsx)(Z.Z,{color:"error","aria-label":"delete row",component:"label",onClick:()=>{t({...n,sellers:n.sellers.filter(r=>r.id!==e.row.original.id).map((e,r)=>({...e,order:r+1}))})},children:(0,l.jsx)(p.Z,{})})})}],[n,t]);return(0,l.jsx)(y.Z,{children:(0,l.jsx)(Y,{columns:s,form:n,setForm:t})})};var F=n(8719),P=n(8110),z=n(2359),C=n(1316),D=n(3345),_=n(6818),B=n(8274),H=n(4112),R=n(3343);let N={date:new Date,driver:null,sellers:[]},U=e=>{let{setAction:r}=e,[n,x]=(0,c.useState)(N),[h,u]=(0,c.useState)(null),{notify:m}=(0,H.d)();(0,c.useEffect)(()=>{h&&!n.sellers.find(e=>Number(e.id)===Number(h.id))&&(x({...n,sellers:[...n.sellers,{...h,id:"".concat(h.id),order:n.sellers.length+1}]}),u(null))},[h,n]);let j=()=>n.date?"Invalid Date"===n.date.toString()?m("Formato de fecha invalido"):n.driver?n.sellers.length?void B.pg.create({date:n.date,userId:n.driver.id,sellers:n.sellers.map(e=>Number(e.id))}).then(()=>{m("Ruta creada correctamente","success"),r("")}).catch(e=>{var r,n;return m((null===(r=e.response)||void 0===r?void 0:null===(n=r.data)||void 0===n?void 0:n.message)||e.message)}):m("Seleccione los sellers de la ruta"):m("Seleccione un driver"):m("Seleccione una fecha");return(0,l.jsxs)(s.ZP,{container:!0,spacing:1,children:[(0,l.jsx)(s.ZP,{item:!0,xs:12,sm:6,md:3,children:(0,l.jsx)(o.Z,{children:(0,l.jsx)(z._,{dateAdapter:P.H,locale:D.Z,children:(0,l.jsx)(C.M,{label:"Fecha",inputFormat:"dd/MM/yyyy",value:n.date,onChange:e=>x({...n,date:e}),renderInput:e=>(0,l.jsx)(a.Z,{...e,fullWidth:!0})})})})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,md:6,lg:3,children:(0,l.jsx)(o.Z,{children:(0,l.jsx)(F.Z,{value:n.driver,onChange:e=>x({...n,driver:e})})})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,md:6,lg:3,children:(0,l.jsx)(o.Z,{children:(0,l.jsx)(d.h1,{value:h,onChange:u,idsDisabled:n.sellers.map(e=>Number(e.id))})})}),(0,l.jsx)(s.ZP,{item:!0,xs:12,md:6,lg:3,children:(0,l.jsxs)(i.Z,{"aria-label":"outlined primary button group",children:[(0,l.jsx)(t.Z,{variant:"outlined",fullWidth:!0,startIcon:(0,l.jsx)(R.Z,{}),sx:{mt:1},onClick:()=>r(""),children:"Cancelar"}),(0,l.jsx)(t.Z,{variant:"contained",fullWidth:!0,startIcon:(0,l.jsx)(_.Z,{}),sx:{mt:1},onClick:j,children:"Guardar"})]})}),!!n.sellers.length&&(0,l.jsx)(s.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,l.jsx)(o.Z,{children:(0,l.jsx)(A,{sellers:n.sellers,form:n,setForm:x})})})]})};var E=n(7357),I=n(7922),G=n(5861),O=n(5503),T=n(813),M=n(1459),W=n(1664),X=n.n(W),L=n(2665),Q=n(7517),q=n(7279);let K=Q.mM.create({body:{paddingTop:35,paddingBottom:65,paddingHorizontal:35},title:{fontSize:18,textAlign:"center",fontFamily:"Oswald"},author:{fontSize:12,textAlign:"center",marginBottom:20},subtitle:{fontSize:15,margin:2,fontFamily:"Oswald"},text:{margin:12,fontSize:14,textAlign:"justify",fontFamily:"Times-Roman"},image:{marginHorizontal:150,width:250},imageRef:{marginHorizontal:50,width:100},header:{fontSize:12,marginBottom:5,textAlign:"center",color:"grey"},pageNumber:{position:"absolute",fontSize:12,bottom:30,left:0,right:0,textAlign:"center",color:"grey"},link:{fontFamily:"Lato",fontSize:10,color:"black",textDecoration:"none",alignSelf:"flex-end",justifySelf:"flex-end"}});Q.Zx.register({family:"Oswald",src:"https://fonts.gstatic.com/s/oswald/v13/Y_TKV6o8WovbUd3m_X9aAA.ttf"});let V=e=>{let{children:r,...n}=e;return(0,l.jsx)(Q.xv,{style:K.subtitle,...n,children:r})},$=e=>{let{route:r}=e;return console.log({route:r}),(0,l.jsx)(Q.BB,{children:(0,l.jsxs)(Q.T3,{style:K.body,wrap:!0,children:[(0,l.jsx)(Q.xv,{style:K.header,fixed:!0,children:"~ Ruta ~"}),(0,l.jsxs)(Q.xv,{style:K.header,fixed:!0,children:[r.user.name," - ",(0,M.p)(r.date)]}),r.sellers.map((e,r)=>(0,l.jsxs)("div",{children:[(0,l.jsxs)(V,{break:!0,children:["Punto ",r+1,": ",e.nombre," -"," ",(0,l.jsx)(Q.rU,{src:e.linkUbicacion,children:"Ubicacion"})]}),(0,l.jsx)(Q.Ee,{style:K.image,src:(0,q.F)(e.image)}),(0,l.jsx)(V,{children:"Telefonos"}),e.referencePhones.length?(0,l.jsx)(Q.G7,{style:{flexDirection:"column"},children:e.referencePhones.map(e=>(0,l.jsxs)(Q.G7,{style:{flexDirection:"row",marginBottom:4},children:[(0,l.jsx)(Q.xv,{style:{marginHorizontal:8},children:"•"}),(0,l.jsxs)(Q.xv,{style:{fontSize:12},children:[e.name," - ",e.phone]})]},e.id))}):(0,l.jsx)(Q.G7,{style:{flexDirection:"column"},children:(0,l.jsxs)(Q.G7,{style:{flexDirection:"row",marginBottom:4},children:[(0,l.jsx)(Q.xv,{style:{marginHorizontal:8},children:"•"}),(0,l.jsx)(Q.xv,{style:{fontSize:12},children:"Sin telefonos"})]})}),(0,l.jsx)(V,{children:"Referencias"}),e.references.length?(0,l.jsx)(Q.G7,{style:{flexDirection:"column"},children:e.references.map(e=>(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(Q.G7,{style:{flexDirection:"row",marginBottom:4},children:[(0,l.jsx)(Q.xv,{style:{marginHorizontal:8},children:"•"}),(0,l.jsxs)(Q.xv,{style:{fontSize:12},children:[e.description," ",e.link&&" - "," ",e.link&&(0,l.jsx)(Q.rU,{src:e.link,children:"Ubicacion"})]})]},e.id),e.image&&(0,l.jsx)(Q.Ee,{style:K.imageRef,src:(0,q.F)(e.image)})]}))}):(0,l.jsx)(Q.G7,{style:{flexDirection:"column"},children:(0,l.jsxs)(Q.G7,{style:{flexDirection:"row",marginBottom:4},children:[(0,l.jsx)(Q.xv,{style:{marginHorizontal:8},children:"•"}),(0,l.jsx)(Q.xv,{style:{fontSize:12},children:"Sin referencias"})]})}),e.personaQueAtiende&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(V,{children:"Persona que atiende"}),(0,l.jsx)(Q.xv,{style:K.text,children:e.personaQueAtiende})]}),(0,l.jsx)(V,{children:"Direccion"}),(0,l.jsxs)(Q.xv,{style:K.text,children:[e.calle," ",e.numero," ",e.colonia,", ",e.ciudad,", ",e.cp," ",e.municipio,", ",e.estado]})]},e.id)),(0,l.jsx)(Q.xv,{style:K.pageNumber,render:e=>{let{pageNumber:r,totalPages:n}=e;return"".concat(r," / ").concat(n)},fixed:!0})]})})};function J(e){let{row:r,removeRoute:n}=e,[t,s]=c.useState(!1);return(0,l.jsxs)(c.Fragment,{children:[(0,l.jsxs)(d.AF,{sx:{"& > *":{borderBottom:"unset"}},children:[(0,l.jsx)(d.Yk,{children:(0,l.jsx)(Z.Z,{"aria-label":"expand row",size:"small",onClick:()=>s(!t),children:t?(0,l.jsx)(T.Z,{}):(0,l.jsx)(O.Z,{})})}),(0,l.jsx)(d.Yk,{component:"th",scope:"row",children:r.id}),(0,l.jsx)(d.Yk,{children:(0,M.p)(r.date)}),(0,l.jsx)(d.Yk,{children:r.user.name}),(0,l.jsx)(d.Yk,{children:(0,M.j)(r.createdAt)}),(0,l.jsx)(d.Yk,{children:(0,M.j)(r.updatedAt)}),(0,l.jsx)(d.Yk,{align:"center",children:(0,l.jsxs)(i.Z,{"aria-label":"outlined primary button group",children:[(0,l.jsx)(Z.Z,{color:"error","aria-label":"delete row",component:"label",children:(0,l.jsx)(Q.WD,{document:(0,l.jsx)($,{route:r}),fileName:"".concat((0,M.p)(r.date)," - ").concat(r.user.name,".pdf"),children:()=>(0,l.jsx)(L.Z,{color:"error"})})}),(0,l.jsx)(Z.Z,{color:"error","aria-label":"delete row",component:"label",onClick:()=>n(r.id),children:(0,l.jsx)(p.Z,{})})]})})]}),(0,l.jsx)(d.AF,{children:(0,l.jsx)(d.Yk,{style:{paddingBottom:0,paddingTop:0},colSpan:7,children:(0,l.jsx)(I.Z,{in:t,timeout:"auto",unmountOnExit:!0,children:(0,l.jsxs)(E.Z,{sx:{margin:1},children:[(0,l.jsx)(G.Z,{variant:"h6",gutterBottom:!0,component:"div",children:"Puntos"}),(0,l.jsxs)(b.Z,{size:"small","aria-label":"purchases",children:[(0,l.jsx)(k.Z,{children:(0,l.jsxs)(d.AF,{children:[(0,l.jsx)(d.Yk,{children:"Punto"}),(0,l.jsx)(d.Yk,{children:"UUID"}),(0,l.jsx)(d.Yk,{children:"NOMBRE"}),(0,l.jsx)(d.Yk,{children:"UBICACION"})]})}),(0,l.jsx)(v.Z,{children:r.sellers.map((e,r)=>(0,l.jsxs)(d.AF,{children:[(0,l.jsx)(d.Yk,{component:"th",scope:"row",children:r+1}),(0,l.jsx)(d.Yk,{children:e.uuid}),(0,l.jsx)(d.Yk,{children:e.nombre}),(0,l.jsx)(d.Yk,{children:(0,l.jsx)(X(),{href:e.linkUbicacion,target:"_blank",children:e.linkUbicacion})})]},e.id))})]})]})})})})]})}var ee=function(){let[e,r]=(0,c.useState)([]),{notify:n}=(0,H.d)(),i=()=>B.pg.getAll().then(r),t=e=>{B.pg.remove(e).then(()=>{i(),n("Ruta eliminada correctamente","success")}).catch(e=>{var r,l;return n((null===(r=e.response)||void 0===r?void 0:null===(l=r.data)||void 0===l?void 0:l.message)||e.message)})};return(0,c.useEffect)(()=>{i()},[]),(0,l.jsx)(y.Z,{component:o.Z,children:(0,l.jsxs)(b.Z,{"aria-label":"collapsible table",children:[(0,l.jsx)(k.Z,{children:(0,l.jsxs)(d.AF,{children:[(0,l.jsx)(d.Yk,{}),(0,l.jsx)(d.Yk,{children:"ID"}),(0,l.jsx)(d.Yk,{children:"Fecha de ruta"}),(0,l.jsx)(d.Yk,{children:"Driver"}),(0,l.jsx)(d.Yk,{children:"Fecha Creacion"}),(0,l.jsx)(d.Yk,{children:"Ultima actualizacion"}),(0,l.jsx)(d.Yk,{align:"center",children:"Acciones"})]})}),(0,l.jsx)(v.Z,{children:e.map(e=>(0,l.jsx)(J,{row:e,removeRoute:t},e.id))})]})})},er=n(3318),en=n(5843),el=function(){let[e,r]=(0,c.useState)("");return(0,l.jsx)(er.Z,{title:"Rutas",children:(0,l.jsxs)(s.ZP,{container:!0,spacing:1,children:[""===e&&(0,l.jsx)(s.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,l.jsx)(i.Z,{variant:"contained","aria-label":"outlined primary button group",children:(0,l.jsx)(t.Z,{startIcon:(0,l.jsx)(en.Z,{}),onClick:()=>r("add"),children:"Agregar"})})}),["add","edit"].includes(e)&&(0,l.jsx)(s.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,l.jsx)(U,{setAction:r})}),""===e&&(0,l.jsx)(s.ZP,{item:!0,xs:12,md:12,lg:12,children:(0,l.jsx)(ee,{})})]})})}},7279:function(e,r,n){"use strict";n.d(r,{F:function(){return l}});let l=e=>"https://api.transportesferreira.com/static/images/sellers/".concat(e)},2480:function(){}},function(e){e.O(0,[885,111,474,445,186,58,519,161,786,965,840,507,307,597,774,888,179],function(){return e(e.s=6393)}),_N_E=e.O()}]);